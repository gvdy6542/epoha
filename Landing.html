<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–∏—Å—Ç–µ–º–∞ –∑–∞ –æ—Ç—á–∏—Ç–∞–Ω–µ –Ω–∞ –º–∞–≥–∞–∑–∏–Ω</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .container {
      max-width: 1000px;
      width: 100%;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    header {
      background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }
    
    .content {
      padding: 40px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }
    
    @media (max-width: 768px) {
      .content {
        grid-template-columns: 1fr;
      }
    }
    
    .features {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .feature {
      display: flex;
      align-items: flex-start;
      gap: 15px;
    }
    
    .feature-icon {
      background-color: #4b6cb7;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .feature-text h3 {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .feature-text p {
      color: #7f8c8d;
      line-height: 1.5;
    }
    
    .auth-section {
      background-color: #f8f9fa;
      padding: 25px;
      border-radius: 10px;
    }
    
    .auth-section h2 {
      margin-bottom: 20px;
      color: #2c3e50;
      text-align: center;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #2c3e50;
    }
    
    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: #4b6cb7;
      box-shadow: 0 0 0 2px rgba(75, 108, 183, 0.2);
    }
    
    button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }
    
    .divider {
      text-align: center;
      margin: 20px 0;
      position: relative;
    }
    
    .divider::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 1px;
      background-color: #ddd;
    }
    
    .divider span {
      background-color: #f8f9fa;
      padding: 0 15px;
      position: relative;
      color: #7f8c8d;
    }
    
    .admin-btn {
      background: linear-gradient(90deg, #ff7e5f 0%, #feb47b 100%);
    }
    
    footer {
      text-align: center;
      padding: 20px;
      color: #7f8c8d;
      border-top: 1px solid #eee;
      margin-top: 20px;
    }
    
    .error {
      color: #e74c3c;
      margin-top: 5px;
      font-size: 14px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>–°–∏—Å—Ç–µ–º–∞ –∑–∞ –æ—Ç—á–∏—Ç–∞–Ω–µ –Ω–∞ –º–∞–≥–∞–∑–∏–Ω</h1>
      <p>–ü—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏—Ö–æ–¥–∏, —Ä–∞–∑—Ö–æ–¥–∏ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä</p>
    </header>
    
    <div class="content">
      <div class="features">
        <div class="feature">
          <div class="feature-icon">üìä</div>
          <div class="feature-text">
            <h3>–û—Ç—á–∏—Ç–∞–Ω–µ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
            <p>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–π—Ç–µ –≤—Å–∏—á–∫–∏ –ø—Ä–∏—Ö–æ–¥–∏ –∏ —Ä–∞–∑—Ö–æ–¥–∏ –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ —Å –¥–µ—Ç–∞–π–ª–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è.</p>
          </div>
        </div>
        
        <div class="feature">
          <div class="feature-icon">üí∞</div>
          <div class="feature-text">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞—Å–∞</h3>
            <p>–°–ª–µ–¥–µ—Ç–µ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏—Ç–µ, –ø—Ä–∞–≤–µ—Ç–µ –±—Ä–æ–µ–Ω–µ –Ω–∞ –ø–∞—Ä–∏ –∏ –ø—Ä–∏–∫–ª—é—á–≤–∞–π—Ç–µ —Ä–∞–±–æ—Ç–Ω–∏ –¥–Ω–∏.</p>
          </div>
        </div>
        
        <div class="feature">
          <div class="feature-icon">üìã</div>
          <div class="feature-text">
            <h3>–î–µ—Ç–∞–π–ª–Ω–∏ —Å–ø—Ä–∞–≤–∫–∏</h3>
            <p>–ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ —Å–ø—Ä–∞–≤–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–∏ –æ—Ç—á–µ—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑ –Ω–∞ –¥–µ–π–Ω–æ—Å—Ç—Ç–∞.</p>
          </div>
        </div>
        
        <div class="feature">
          <div class="feature-icon">üë•</div>
          <div class="feature-text">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç–∞–≤—á–∏—Ü–∏</h3>
            <p>–ü–æ–¥–¥—ä—Ä–∂–∞–π—Ç–µ –ø—ä–ª–µ–Ω —Ä–µ–≥–∏—Å—Ç—ä—Ä –Ω–∞ –¥–æ—Å—Ç–∞–≤—á–∏—Ü–∏ –∏ —Ç–µ—Ö–Ω–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏.</p>
          </div>
        </div>
      </div>
      
      <div class="auth-section">
        <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞</h2>
        
        <form id="loginForm">
          <div class="form-group">
            <label for="email">–ò–º–µ–π–ª –∞–¥—Ä–µ—Å</label>
            <input type="email" id="email" placeholder="–≤–∞—à–∏—è—Ç@–∏–º–µ–π–ª.com" required>
            <div class="error" id="emailError">–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª –∞–¥—Ä–µ—Å</div>
          </div>
          
          <div class="form-group">
            <label for="password">–ü–∞—Ä–æ–ª–∞</label>
            <input type="password" id="password" placeholder="–í–∞—à–∞—Ç–∞ –ø–∞—Ä–æ–ª–∞" required>
            <div class="error" id="passwordError">–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞</div>
          </div>
          
          <button type="submit" id="loginBtn">–í–ª–µ–∑ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞</button>
        </form>
        
        <div class="divider">
          <span>–∏–ª–∏</span>
        </div>
        
        <button id="adminBtn" class="admin-btn">–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∞</button>
      </div>
    </div>
    
    <footer>
      <p>&copy; 2023 –°–∏—Å—Ç–µ–º–∞ –∑–∞ –æ—Ç—á–∏—Ç–∞–Ω–µ –Ω–∞ –º–∞–≥–∞–∑–∏–Ω. –í—Å–∏—á–∫–∏ –ø—Ä–∞–≤–∞ –∑–∞–ø–∞–∑–µ–Ω–∏.</p>
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const loginForm = document.getElementById('loginForm');
      const emailInput = document.getElementById('email');
      const passwordInput = document.getElementById('password');
      const emailError = document.getElementById('emailError');
      const passwordError = document.getElementById('passwordError');
      const loginBtn = document.getElementById('loginBtn');
      const adminBtn = document.getElementById('adminBtn');
      
      function isValidEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }
      
      function showError(input, errorElement, message) {
        input.style.borderColor = '#e74c3c';
        errorElement.textContent = message;
        errorElement.style.display = 'block';
      }
      
      function hideError(input, errorElement) {
        input.style.borderColor = '#ddd';
        errorElement.style.display = 'none';
      }
      
      emailInput.addEventListener('input', function() {
        if (!isValidEmail(emailInput.value)) {
          showError(emailInput, emailError, '–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª –∞–¥—Ä–µ—Å');
        } else {
          hideError(emailInput, emailError);
        }
      });
      
      passwordInput.addEventListener('input', function() {
        if (passwordInput.value.length < 1) {
          showError(passwordInput, passwordError, '–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞');
        } else {
          hideError(passwordInput, passwordError);
        }
      });
      
      loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        let isValid = true;
        
        if (!isValidEmail(emailInput.value)) {
          showError(emailInput, emailError, '–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª –∞–¥—Ä–µ—Å');
          isValid = false;
        } else {
          hideError(emailInput, emailError);
        }
        
        if (passwordInput.value.length < 1) {
          showError(passwordInput, passwordError, '–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞');
          isValid = false;
        } else {
          hideError(passwordInput, passwordError);
        }
        
        if (isValid) {
          loginBtn.textContent = '–í—Ö–æ–¥...';
          loginBtn.disabled = true;

          const storeToken = (token, user) => {
            const data = JSON.stringify(user || {});
            try {
              localStorage.setItem('token', token);
              localStorage.setItem('user', data);
              return true;
            } catch {
              try {
                sessionStorage.setItem('token', token);
                sessionStorage.setItem('user', data);
                return true;
              } catch {
                return false;
              }
            }
          };

          google.script.run
            .withSuccessHandler(res => {
              const token = res.token;
              const user = res.user || {};
              const stored = storeToken(token, user);
              const nextUrl = new URL(window.location.href);
              nextUrl.searchParams.set('page', 'admin');
              if (!stored) {
                nextUrl.searchParams.set('token', token);
              } else {
                nextUrl.searchParams.delete('token');
              }
              window.location.href = nextUrl.toString();
            })
            .withFailureHandler(err => {
              alert(err.message || err);
              loginBtn.textContent = '–í–ª–µ–∑ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞';
              loginBtn.disabled = false;
            })
            .login(emailInput.value.trim(), passwordInput.value);
        }
      });

      adminBtn.addEventListener('click', function() {
        let token = localStorage.getItem('token') || sessionStorage.getItem('token');
        if (!token) {
          alert('–ú–æ–ª—è, –≤–ª–µ–∑ –ø—ä—Ä–≤–æ.');
          return;
        }
        window.location.href = '?page=admin';
      });
    });
  </script>
</body>
</html>
